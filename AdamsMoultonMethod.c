/* Adams Moulton Method */
#include <stdio.h>
#include <math.h>
#define N 40
float f1(float x,float y)
{ return(-0.5*x/y); }
int main(void){
    int i;
    float x[N+1],y[N+1],h=0.2,r,A,B,C,D;
    x[0]=0.0;
    y[0]=2.0;
    i=0;
    printf(" x , y ( error )\n");
    do {
        x[i+1]=x[i]+h;
        if(i<4) {
            A=h*f1(x[i],y[i]);
            B=h*f1(x[i]+h/2.0,y[i]+A/2.0);
            C=h*f1(x[i]+h/2.0,y[i]+B/2.0);
            D=h*f1(x[i]+h,y[i]+C);
            y[i+1]=y[i]+(A+2.0*B+2.0*C+D)/6.0;
        } else {
            y[i+1]=y[i]+(55.0*f1(x[i],y[i])
            -59.0*f1(x[i-1],y[i-1])
            +37.0*f1(x[i-2],y[i-2])
            -9.0*f1(x[i-3],y[i-3]))*h/24.0;
            
        }
        i++;
        r=sqrt(4-pow(x[i],2)/2);
        printf("%8.5f,%8.5f (%8.5f)\n",x[i],y[i],r-y[i]);
    } while(x[i]<2.0&&i<N);
}

/*
x , y ( error )
 0.20000, 1.99499 ( 0.00000)
 0.40000, 1.97990 ( 0.00000)
 0.60000, 1.95448 ( 0.00000)
 0.80000, 1.91833 ( 0.00000)
 1.00000, 1.87084 (-0.00002)
 1.20000, 1.81112 (-0.00004)
 1.40000, 1.73790 (-0.00009)
 1.60000, 1.64941 (-0.00017)
 1.80000, 1.54304 (-0.00031)
 2.00000, 1.41483 (-0.00062)
*/